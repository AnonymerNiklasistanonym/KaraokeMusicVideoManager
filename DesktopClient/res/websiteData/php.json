{"before-html-form": "<?php\n$myarray = explode(\",\", $_REQUEST['index']);\n?>", "custom-head-form": "<meta name=\"theme-color\" content=\"#24a204\" />", "floating-button-form": "<a href=\"#\" onclick=\"history.back();\" class=\"floating-button\"></a>", "before-title-form": "<section class=\"form-bg\"><form action=\"process.php\" class=\"submit-form\"><p class=\"form-title\">", "before-artist-form": "<p class=\"song-title\"><?php echo $myarray[2]; ?></p><p class=\"artist-title\">", "before-input-form": "<?php echo $myarray[1]; ?></p><input type=\"hidden\" name=\"song\" value=\"<?php echo $myarray[0]; ?>\"><input type=\"hidden\" name=\"title\" value=\"<?php echo $myarray[2]; ?>\"><input type=\"hidden\" name=\"artist\" value=\"<?php echo $myarray[1]; ?>\">", "input-form": "<input class=\"requiered-button\" type=\"text\" name=\"author\" placeholder=\"Your name/s...\" required><br><input type=\"text\" name=\"comment\" placeholder=\"Your comment...\"><br>", "before-submit-form": "<br>", "submit-form": "<input class=\"submit-button\" type=\"submit\" value=\"Submit\">", "after-submit-form": "</form></section>", "before-link-process": "<?php\n$date = new DateTime();$current_time = $date->getTimestamp();$content = array('song'=> intval($_GET[\"song\"]), 'title'=> $_GET[\"title\"], 'artist'=> $_GET[\"artist\"], 'author'=> $_GET[\"author\"], 'comment'=> $_GET[\"comment\"], 'time'=> $current_time, 'created-locally'=> false, 'votes'=> 0);$fp = fopen($current_time . '.json', 'w') or die(\"<script type='text/javascript'>alert('fopen failed!');location.href='../html/html_party_live.html';</script>\");fwrite($fp, json_encode($content)) or die(\"<script type='text/javascript'>alert('fwrite failed!');location.href='../html/html_party_live.html';</script>\");fclose($fp) or die(\"<script type='text/javascript'>alert('fclose failed!');location.href='../html/html_party_live.html';</script>\");", "link-process": "echo \"<script>location.href='../html/html_party_live.html';</script>\";", "after-link-process": "\n?>", "php-data-live": "<?php\n$path = \"./\";$files = array_diff(scandir($path), array('..', '.',\"form.php\",\"process.php\", \"live.php\", \"vote.php\", \"ipBook.json\"));$allData = array();$allTimestamps = array();$allVotes = array();$allAuthors = array();$allTitles = array();$allArtists = array();$counter = 1;$counterString = '~##counter##~';foreach ($files as $file) {$str = file_get_contents($path . \"/\" . $file);$json = json_decode($str, true);$song = $json['song'];$title = $json['title'];$artist = $json['artist'];$author = $json['author'];$comment = $json['comment'];$time = $json['time'];$readableTime = date(\"H:i\", $time);$created = $json['created-locally'];$votes = $json['votes'];$liveElement = \"\";$liveElement = '<div class=\"live-element\">';$liveElement .= '<div class=\"upvote-counter\" id=\"vote' . $counterString . '\">' . $votes . '</div>';$liveElement .= '<div class=\"song-and-artist\">';$liveElement .= '<div class=\"playlist-number\">' . '#' . $counterString . '</div>';$liveElement .= '<div class=\"song-title\">' . $title . '</div>';$liveElement .= '<div class=\"song-artist\">' . 'from ' . $artist . '</div>';$liveElement .= '</div>';$liveElement .= '<div class=\"author-and-comment\">';$liveElement .= '<div class=\"author\">' . '<p class=\"author-text\">' . $author . ' - ' . $readableTime . '</p>' . '</div>';$liveElement .= '<div class=\"scroll-comment\">' . '<marquee behavior=\"scroll\" direction=\"left\" scrollamount=\"5\">' . $comment . '</marquee>' . '</div>';$liveElement .= '</div>';$liveElement .= '<p class=\"text-beta\">' . $comment . '</p>';$liveElement .= '<div class=\"upvotes\">' . '<div class=\"upvote-button\">' . '<button class=\"upvote-button-button\" id=\"' . $counterString . '\">Vote</button>' . '</div>' . '</div>';$liveElement .= '<div class=\"hidden-filename\" id=\"file' . $counterString . '\">' . $file . '</div>';$liveElement .= '</div>';array_push($allData, $liveElement);array_push($allTimestamps, $time);array_push($allVotes, $votes);array_push($allTitles, $title);array_push($allArtists, $artist);array_push($allAuthors, $author);}array_multisort($allVotes, SORT_DESC, SORT_NUMERIC, $allTimestamps, SORT_ASC, SORT_NUMERIC, $allTitles, SORT_ASC, SORT_STRING, $allArtists, SORT_ASC, SORT_STRING, $allAuthors, SORT_ASC, SORT_STRING, $allData);foreach($allData as $key => $value) {echo str_replace($counterString, $counter, $value);$counter++;}\n?>", "php-data-vote": "<?php\n$fileName = $_GET['file'];$type = $_GET['type'];$path = \".\";$str = file_get_contents($path . \"/\" . $fileName);$json = json_decode($str, true);$votes = $json['votes'];if ($votes < 0) {$votes = 0;}if ($type == 'get') {echo $votes;return;}$ipAddressBook = \"ipBook.json\";$ip_address = $_SERVER['REMOTE_ADDR'];if ($type == 'dec') {$newArrayJson = array();}if (file_exists($ipAddressBook)) {$inp = file_get_contents($ipAddressBook);$tempArray = json_decode($inp);foreach ($tempArray as $v) {if (($v->song === $json['song'] && $v->ip === $ip_address) && $v->original_time === $json['time']) {if ($type == 'inc') {echo $votes;return;} elseif ($type == 'dec') {if ($votes > 0) {$votes = $votes - 1;}}} elseif ($type == 'dec') {array_push($newArrayJson, array('song'=> $v->song, 'ip'=> $v->ip, 'original_time'=> $v->original_time, 'unixtime'=> $v->unixtime));}}} else {$tempArray = array();}if ($type == 'inc') {$votes = $votes + 1;$date = new DateTime();array_push($tempArray, array('song'=> $json['song'], 'ip'=> $_SERVER['REMOTE_ADDR'], 'original_time'=> $json['time'], 'unixtime'=> $date->getTimestamp()));} elseif ($type == 'dec') {$tempArray = $newArrayJson;}$jsonData = json_encode($tempArray);file_put_contents($path . \"/\" . $ipAddressBook, $jsonData);$newData = array('song'=> $json['song'], 'title'=> $json['title'], 'artist'=> $json['artist'], 'author'=> $json['author'], 'comment'=> $json['comment'], 'time'=> $json['time'], 'created-locally'=> $json['created-locally'], 'votes'=> $votes);$newJsonString = json_encode($newData);$file = $path . \"/\" . $fileName;if (!file_exists($file)) {echo \"<script type='text/javascript'>alert('\" . $path . \"/\" . $fileName . \" doesn't exists!\" . \"');</script>\";}$fp = fopen($file, 'w') or die(\"<script type='text/javascript'>alert('fopen failed!');</script>\");fwrite($fp,  $newJsonString) or die(\"<script type='text/javascript'>alert('fwrite failed!');</script>\");fclose($fp) or die(\"<script type='text/javascript'>alert('fclose failed!');</script>\");echo $votes;\n?>"}